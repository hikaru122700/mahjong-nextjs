# 麻雀点数計算機 使い方ガイド

このガイドでは、麻雀点数計算機の詳しい使い方を説明します。

## 目次

1. [基本的な使い方](#基本的な使い方)
2. [手牌の入力](#手牌の入力)
3. [鳴き（副露）の入力](#鳴き副露の入力)
4. [和了条件の設定](#和了条件の設定)
5. [ドラの設定](#ドラの設定)
6. [赤ドラの扱い](#赤ドラの扱い)
7. [計算結果の見方](#計算結果の見方)
8. [履歴機能](#履歴機能)
9. [よくある質問](#よくある質問)

---

## 基本的な使い方

### 1. 手牌を選択する

画面上部の「牌を選択」セクションから、手牌を選択します。

- **萬子（マンズ）**: 1m～9m
- **筒子（ピンズ）**: 1p～9p
- **索子（ソーズ）**: 1s～9s
- **字牌**: 東、南、西、北、白、發、中

牌をクリックすると、自動的に手牌エリアに追加されます。

### 2. 和了牌を選択する

手牌が13枚になると、次に選択した牌が自動的に和了牌として設定されます。

### 3. 和了条件を設定する

画面右側の「和了条件」セクションで、以下の条件を設定します：

- 和了方法（ツモ/ロン）
- 場風（東/南/西）
- 自風（東/南/西/北）
- 親番（親/子）
- リーチ、ダブルリーチ、一発
- その他の特殊条件

### 4. 点数を計算する

すべての設定が完了したら、「点数を計算する」ボタンをクリックします。

### 5. 結果を確認する

計算結果が情報パネルの「結果」タブに表示されます：

- 翻数（ハン）
- 符（フ）
- 点数
- 成立役の一覧

---

## 手牌の入力

### 牌の選択方法

**方法1: クリックで選択**

1. 画面上部の「牌を選択」セクションを確認
2. 「手牌に追加」モードになっていることを確認（デフォルト）
3. 必要な牌をクリック

**方法2: 同じ牌を複数枚選択**

同じ牌を複数回クリックすると、最大4枚まで選択できます。

### 牌の削除

手牌エリアに表示されている牌をクリックすると削除できます。

### 手牌のソート

手牌は自動的にソート（並び替え）されます。

### 牌の上限

各牌は最大4枚まで選択できます（麻雀牌の実際の枚数制限）。
4枚選択済みの牌は、グレーアウトして選択できなくなります。

---

## 鳴き（副露）の入力

### 鳴きの追加手順

1. **鳴きの種類を選択**
   - 「手牌に追加」を「鳴きに追加」に切り替え
   - 下部の鳴き入力エリアで種類を選択：
     - **チー（順子）**: 3枚
     - **ポン（刻子）**: 3枚
     - **明カン（槓子）**: 4枚
     - **暗カン（槓子）**: 4枚

2. **牌を選択**
   - 上部の牌テーブルから必要な牌をクリック
   - チー・ポンは3枚、カンは4枚選択

3. **鳴きを確定**
   - 「鳴きを確定」ボタンをクリック

### 暗槓の表示

暗槓は実際の麻雀に倣い、端の2つの牌が裏向きで表示されます：
- 表示例: 🀫 [1m] [1m] 🀫

### 鳴きの削除

鳴き表示エリアで、削除したい鳴きをクリックします。

### 鳴きと門前の関係

- 鳴き（チー・ポン・明カン）がある場合、自動的に門前ではなくなります
- 暗カンは門前扱いです
- リーチは門前時のみ可能です

---

## 和了条件の設定

### 和了方法

**ツモ / ロン**

- **ツモ**: 自分で引いた牌で和了
- **ロン**: 他家の捨て牌で和了

### 場風・自風

**場風（東/南/西）**
- 東場：東
- 南場：南
- 西場：西（一般的には東南戦で使用しない）

**自風（東/南/西/北）**
- 東家：東
- 南家：南
- 西家：西
- 北家：北

### 親番

**親（東家）/ 子**

点数計算が変わります：
- 親の場合、点数が1.5倍
- ツモの場合、支払い方法が異なる

### リーチ・一発

**リーチ**
- 門前時のみ設定可能
- 1翻

**ダブルリーチ**
- 門前時のみ設定可能
- 2翻（リーチの代わりに）

**一発**
- リーチ時のみ設定可能
- リーチ後1巡目の和了
- 1翻

### 特殊和了条件

**海底摸月（ハイテイツモ）**
- ツモ時のみ
- 最後の牌でツモ和了
- 1翻

**河底撈魚（ホウテイロン）**
- ロン時のみ
- 最後の捨て牌でロン和了
- 1翻

**嶺上開花（リンシャンカイホウ）**
- ツモ時のみ
- カン後の嶺上牌でツモ和了
- 1翻

**槍槓（チャンカン）**
- ロン時のみ
- 他家の加槓に対してロン和了
- 1翻

**流し満貫**
- 特殊な和了
- 5翻

### 役満（特殊条件）

**天和**
- 親の配牌時和了
- 自風が「東」の時のみ設定可能
- 13翻（役満）

**地和**
- 子の第一ツモ和了
- 自風が「東」以外の時のみ設定可能
- 13翻（役満）

### 供託・本場

**供託（リーチ棒）**
- リーチをかけた本数
- 1本につき1,000点加算

**本場（積み棒）**
- 連荘・流局の回数
- 1本場につき300点加算（ツモは各100点）

---

## ドラの設定

### 表示ドラ

1. 「表示ドラ」ボタンをクリック
2. 牌選択モードが「表示ドラ」に切り替わる
3. ドラ表示牌を選択（最大4枚）
4. 自動的に次のドラ牌が計算されます

**ドラ表示牌とドラ牌の関係**
- 1m → 2m
- 9m → 1m
- 東 → 南 → 西 → 北 → 東
- 白 → 發 → 中 → 白

### 裏ドラ

1. リーチを設定
2. 「裏ドラ」ボタンをクリック（リーチ時のみ有効）
3. 裏ドラ表示牌を選択（最大4枚）

### ドラの削除

ドラ設定エリアに表示されている牌をクリックすると削除できます。

---

## 赤ドラの扱い

### 赤ドラの追加方法

1. 牌テーブルで、各色の右端に赤ドラボタンがあります：
   - 赤5m
   - 赤5p
   - 赤5s

2. 赤ドラボタンをクリックすると、赤い枠で表示されます

### 赤ドラの制限

- 各色1枚まで選択可能
- 通常の5mと赤5mは区別されます
- 赤ドラは自動的に1翻加算されます

### 赤ドラの表示

- 赤ドラは赤い枠で表示されます
- 暗槓でも中央の2枚に赤フラグが適用されます

---

## 計算結果の見方

### 情報パネル

計算後、情報パネルの「結果」タブに以下が表示されます：

**基本情報**
- 翻数（ハン）: 合計の翻数
- 符（フ）: 符の計算結果
- 点数: 実際の点数

**詳細な点数内訳**
- 基本点: 翻数と符から計算された基本点数
- 本場: 本場による加算
- 供託: 供託による加算
- 合計: 最終的な受け取り点数

**成立役**
- 成立した役の一覧
- 各役の翻数
- 役満は金色の枠で強調表示

### 点数の表示形式

**親のツモ**
```
2,000点オール（合計6,000点）
```

**子のツモ**
```
子: 1,000点、親: 2,000点（合計4,000点）
```

**ロン**
```
8,000点
```

---

## 履歴機能

### 履歴の保存

計算を実行すると、自動的に履歴に保存されます（最大5件）。

### 履歴の表示

画面下部の「計算履歴」セクションに、過去の計算結果が表示されます：
- 日時
- 翻数・符
- 点数
- 手牌・和了牌
- 成立役

### 履歴の詳細表示

「詳細を表示」ボタンをクリックすると、以下のタブが表示されます：
- **手牌情報**: 手牌・和了牌・鳴きの詳細
- **条件**: 和了条件の設定内容
- **結果**: 点数計算の詳細

### 履歴のクリア

ブラウザのローカルストレージに保存されます。
ブラウザのキャッシュをクリアすると削除されます。

---

## よくある質問

### Q1. 「役がありません」と表示される

**原因**
- 和了形になっていない
- 役が成立していない

**対処法**
1. 手牌が14枚（鳴き含む）になっているか確認
2. 和了形（4面子1雀頭 or 七対子 or 国士無双）になっているか確認
3. 最低1つの役が必要です（ドラのみでは和了できません）

### Q2. 「和了形ではありません」と表示される

**原因**
- 手牌の枚数が正しくない
- 面子が正しく構成されていない

**対処法**
1. 手牌13枚 + 和了牌1枚 = 合計14枚か確認
2. 鳴きがある場合、手牌の枚数を調整
   - 鳴き1回: 手牌10枚 + 和了牌1枚
   - 鳴き2回: 手牌7枚 + 和了牌1枚
   - 鳴き3回: 手牌4枚 + 和了牌1枚
   - 鳴き4回: 手牌1枚 + 和了牌1枚

### Q3. 門前なのにリーチが設定できない

**原因**
- 鳴き（チー・ポン・明カン）がある

**対処法**
- 暗カンのみ門前扱いです
- 鳴きを削除してください

### Q4. 裏ドラが設定できない

**原因**
- リーチが設定されていない

**対処法**
- リーチまたはダブルリーチを設定してください

### Q5. 赤ドラが選択できない

**原因**
- すでに同色の赤ドラが選択されている
- 該当する5の牌が手牌・鳴きにない

**対処法**
- 各色1枚まで選択可能です
- まず通常の5m/5p/5sを手牌に追加してください

### Q6. 点数が合わない

**原因**
- 符計算の特殊ケース
- 待ち形の判定

**対処法**
- 符計算は複雑なため、特殊なケースで差異が出る可能性があります
- 気になる場合はIssueで報告してください

### Q7. 手牌をクリアしたい

画面左下の「すべてクリア」ボタンをクリックすると、すべての設定がリセットされます。

### Q8. 天和・地和の設定方法

1. 天和（親の配牌時和了）
   - 自風を「東」に設定
   - 「天和」にチェック

2. 地和（子の第一ツモ和了）
   - 自風を「南」「西」「北」のいずれかに設定
   - 「地和」にチェック

---

## Tips

### 効率的な入力方法

1. **同じ牌を複数枚選択**: 連続クリックで最大4枚まで
2. **鳴きは先に入力**: 手牌の枚数計算が楽になります
3. **ドラは最後に設定**: 手牌確定後に設定すると間違いが少ないです

### 注意点

- 同じ牌は最大4枚までです
- 手牌は自動的にソートされます
- 鳴きを追加すると必要な手牌の枚数が減ります
- リーチは門前時のみ可能です

---

## トラブルシューティング

### 計算ボタンが押せない

- 和了牌が選択されているか確認してください

### 画面が正しく表示されない

- ブラウザのキャッシュをクリアしてください
- 対応ブラウザ: Chrome, Firefox, Safari, Edge（最新版）

### 計算結果がおかしい

- GitHubのIssueで報告してください
- 手牌、和了条件、期待される結果を記載してください

---

## さらに詳しく

- [README.md](../README.md): プロジェクトの概要
- [GitHub Issues](https://github.com/hikaru122700/mahjong-nextjs/issues): バグ報告・機能要望
- [GitHub Repository](https://github.com/hikaru122700/mahjong-nextjs): ソースコード

---

最終更新: 2025年12月20日
